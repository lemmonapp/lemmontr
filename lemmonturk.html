<!DOCTYPE html>
<html lang="tr" data-theme="dark">
<head>
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover"/>
  <title>LemmOn Mersin</title>
  <meta name="theme-color" content="#000000"/>
  <meta name="description" content="Mersin'in en iyi mekanlarını keşfet"/>
  
  <!-- Firebase SDK -->
  <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-firestore-compat.js"></script>
  
  <style>
    @import url('https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800;900&display=swap');
    
    :root {
      --bg-primary: #000000;
      --bg-secondary: #0a0a0a;
      --surface: #111111;
      --surface-elevated: #1a1a1a;
      --surface-hover: #222222;
      --border: rgba(255,255,255,.06);
      --border-strong: rgba(255,255,255,.12);
      --text-primary: #ffffff;
      --text-secondary: #a8a8a8;
      --text-tertiary: #666666;
      --brand: #FFE500;
      --brand-dim: #FFD700;
      --brand-dark: #E6CF00;
      --accent-green: #00FF94;
      --accent-red: #FF3B5C;
      --accent-blue: #00A8FF;
      --accent-purple: #A855F7;
      --glass-bg: rgba(17,17,17,.85);
      --glass-border: rgba(255,255,255,.08);
      --shadow-sm: 0 2px 8px rgba(0,0,0,.4);
      --shadow-md: 0 4px 16px rgba(0,0,0,.5);
      --shadow-lg: 0 8px 32px rgba(0,0,0,.6);
      --shadow-xl: 0 16px 48px rgba(0,0,0,.7);
      --shadow-glow: 0 0 20px rgba(255,229,0,.3);
      --radius-sm: 8px;
      --radius-md: 12px;
      --radius-lg: 16px;
      --radius-xl: 24px;
      --radius-full: 9999px;
      --ease-out: cubic-bezier(0.16, 1, 0.3, 1);
      --ease-spring: cubic-bezier(0.68, -0.55, 0.265, 1.55);
    }
    
    html[data-theme="light"] {
      --bg-primary: #ffffff;
      --bg-secondary: #fafafa;
      --surface: #ffffff;
      --surface-elevated: #ffffff;
      --surface-hover: #f5f5f5;
      --border: rgba(0,0,0,.06);
      --border-strong: rgba(0,0,0,.12);
      --text-primary: #000000;
      --text-secondary: #666666;
      --text-tertiary: #999999;
      --glass-bg: rgba(255,255,255,.85);
      --glass-border: rgba(0,0,0,.08);
      --shadow-sm: 0 2px 8px rgba(0,0,0,.08);
      --shadow-md: 0 4px 16px rgba(0,0,0,.1);
      --shadow-lg: 0 8px 32px rgba(0,0,0,.12);
      --shadow-xl: 0 16px 48px rgba(0,0,0,.15);
    }

    *, *::before, *::after {
      box-sizing: border-box;
      margin: 0;
      padding: 0;
    }
    
    body {
      font-family: 'Inter', -apple-system, BlinkMacSystemFont, sans-serif;
      background: var(--bg-primary);
      color: var(--text-primary);
      line-height: 1.6;
      -webkit-font-smoothing: antialiased;
      -moz-osx-font-smoothing: grayscale;
      font-feature-settings: 'cv02', 'cv03', 'cv04', 'cv11';
      overflow-x: hidden;
    }
    
    ::-webkit-scrollbar {
      width: 4px;
    }
    
    ::-webkit-scrollbar-track {
      background: transparent;
    }
    
    ::-webkit-scrollbar-thumb {
      background: var(--brand);
      border-radius: var(--radius-full);
    }
    
    ::selection {
      background: var(--brand);
      color: #000;
    }

    .container {
      max-width: 600px;
      margin: 0 auto;
      min-height: 100vh;
      position: relative;
      background: var(--bg-primary);
    }

    header {
      position: sticky;
      top: 0;
      z-index: 100;
      backdrop-filter: blur(20px) saturate(180%);
      background: var(--glass-bg);
      border-bottom: 1px solid var(--border);
      box-shadow: var(--shadow-sm);
    }
    
    .header-row {
      display: flex;
      align-items: center;
      justify-content: space-between;
      padding: 16px 20px;
      gap: 16px;
    }
    
    .brand {
      display: flex;
      align-items: center;
      gap: 10px;
      font-size: 24px;
      font-weight: 800;
      letter-spacing: -0.5px;
      color: var(--text-primary);
      cursor: pointer;
      user-select: none;
      transition: all 0.3s var(--ease-out);
    }
    
    .brand:active {
      transform: scale(0.96);
    }
    
    .brand-emoji {
      font-size: 32px;
      filter: drop-shadow(0 0 10px rgba(255,229,0,.4));
      animation: float 3s ease-in-out infinite;
    }
    
    @keyframes float {
      0%, 100% { transform: translateY(0px); }
      50% { transform: translateY(-4px); }
    }
    
    .header-actions {
      display: flex;
      gap: 8px;
    }

    .btn {
      padding: 10px 18px;
      border: none;
      border-radius: var(--radius-full);
      font-size: 14px;
      font-weight: 600;
      cursor: pointer;
      transition: all 0.3s var(--ease-out);
      display: inline-flex;
      align-items: center;
      justify-content: center;
      gap: 8px;
      position: relative;
      overflow: hidden;
      white-space: nowrap;
    }
    
    .btn::before {
      content: '';
      position: absolute;
      inset: 0;
      background: linear-gradient(135deg, rgba(255,255,255,.1), transparent);
      opacity: 0;
      transition: opacity 0.3s;
    }
    
    .btn:hover::before {
      opacity: 1;
    }
    
    .btn-primary {
      background: var(--brand);
      color: #000;
      font-weight: 700;
      box-shadow: 0 4px 12px rgba(255,229,0,.3);
    }
    
    .btn-primary:hover {
      transform: translateY(-2px);
      box-shadow: 0 6px 20px rgba(255,229,0,.4);
    }
    
    .btn-primary:active {
      transform: translateY(0);
    }
    
    .btn-secondary {
      background: var(--surface-elevated);
      color: var(--text-primary);
      border: 1px solid var(--border);
    }
    
    .btn-secondary:hover {
      background: var(--surface-hover);
      border-color: var(--border-strong);
    }
    
    .btn-icon {
      width: 40px;
      height: 40px;
      padding: 0;
      background: var(--surface);
      color: var(--text-secondary);
      border: 1px solid var(--border);
      border-radius: var(--radius-full);
      font-size: 18px;
      transition: all 0.3s var(--ease-out);
    }
    
    .btn-icon:hover {
      background: var(--surface-hover);
      color: var(--text-primary);
      border-color: var(--border-strong);
      transform: scale(1.05);
    }
    
    .btn-icon:active {
      transform: scale(0.95);
    }

    .input {
      width: 100%;
      padding: 14px 16px;
      background: var(--surface);
      border: 1px solid var(--border);
      border-radius: var(--radius-md);
      color: var(--text-primary);
      font-size: 15px;
      font-family: inherit;
      transition: all 0.3s var(--ease-out);
      outline: none;
    }
    
    .input:focus {
      border-color: var(--brand);
      box-shadow: 0 0 0 3px rgba(255,229,0,.1);
      background: var(--surface-elevated);
    }
    
    .input::placeholder {
      color: var(--text-tertiary);
    }
    
    select.input {
      cursor: pointer;
    }
    
    textarea.input {
      resize: vertical;
      min-height: 100px;
    }

    .search-bar {
      padding: 16px 20px 20px;
      background: transparent;
    }
    
    .search-wrapper {
      position: relative;
    }
    
    #search-input {
      padding-left: 48px;
      padding-right: 16px;
      height: 50px;
      border-radius: var(--radius-full);
      font-size: 16px;
      background: var(--surface);
      border: 1px solid var(--border);
      transition: all 0.4s var(--ease-out);
    }
    
    #search-input:focus {
      transform: scale(1.01);
      box-shadow: 0 4px 20px rgba(0,0,0,.2);
    }
    
    .search-icon {
      position: absolute;
      left: 18px;
      top: 50%;
      transform: translateY(-50%);
      font-size: 20px;
      opacity: 0.5;
      transition: all 0.3s;
      pointer-events: none;
    }
    
    #search-input:focus ~ .search-icon {
      opacity: 1;
      color: var(--brand);
    }

    .categories {
      padding: 0 20px 20px;
      overflow-x: auto;
      display: flex;
      gap: 10px;
      scrollbar-width: none;
      -ms-overflow-style: none;
    }
    
    .categories::-webkit-scrollbar {
      display: none;
    }
    
    .category-chip {
      padding: 10px 18px;
      background: var(--surface);
      border: 1px solid var(--border);
      border-radius: var(--radius-full);
      font-size: 14px;
      font-weight: 600;
      color: var(--text-secondary);
      cursor: pointer;
      transition: all 0.3s var(--ease-out);
      white-space: nowrap;
      display: inline-flex;
      align-items: center;
      gap: 6px;
    }
    
    .category-chip:hover {
      background: var(--surface-hover);
      color: var(--text-primary);
      border-color: var(--border-strong);
      transform: translateY(-2px);
    }
    
    .category-chip.active {
      background: var(--brand);
      color: #000;
      border-color: var(--brand);
      box-shadow: 0 4px 12px rgba(255,229,0,.3);
      font-weight: 700;
    }

    .filters {
      padding: 0 20px 16px;
      display: flex;
      gap: 10px;
      overflow-x: auto;
      scrollbar-width: none;
    }
    
    .filters::-webkit-scrollbar {
      display: none;
    }
    
    .filter-btn {
      padding: 8px 14px;
      background: var(--surface);
      border: 1px solid var(--border);
      border-radius: var(--radius-full);
      font-size: 13px;
      font-weight: 600;
      color: var(--text-secondary);
      cursor: pointer;
      transition: all 0.3s;
      white-space: nowrap;
    }
    
    .filter-btn:hover,
    .filter-btn.active {
      background: var(--surface-elevated);
      color: var(--text-primary);
      border-color: var(--border-strong);
    }

    main {
      padding: 0 20px 80px;
    }
    
    .place-card {
      background: var(--surface);
      border: 1px solid var(--border);
      border-radius: var(--radius-lg);
      padding: 20px;
      margin-bottom: 16px;
      cursor: pointer;
      transition: all 0.4s var(--ease-out);
      position: relative;
      overflow: hidden;
    }
    
    .place-card::before {
      content: '';
      position: absolute;
      inset: 0;
      background: linear-gradient(135deg, rgba(255,229,0,.05), transparent);
      opacity: 0;
      transition: opacity 0.4s;
    }
    
    .place-card:hover {
      transform: translateY(-4px) scale(1.01);
      box-shadow: var(--shadow-lg);
      border-color: var(--brand);
    }
    
    .place-card:hover::before {
      opacity: 1;
    }
    
    .place-card:active {
      transform: translateY(-2px) scale(1.005);
    }
    
    .place-header {
      display: flex;
      justify-content: space-between;
      align-items: flex-start;
      gap: 16px;
      margin-bottom: 12px;
      position: relative;
      z-index: 1;
    }
    
    .place-name {
      font-size: 20px;
      font-weight: 700;
      letter-spacing: -0.3px;
      color: var(--text-primary);
      margin-bottom: 8px;
      line-height: 1.3;
    }
    
    .place-meta {
      display: flex;
      gap: 8px;
      flex-wrap: wrap;
      align-items: center;
    }
    
    .place-category,
    .place-district,
    .place-price {
      display: inline-flex;
      align-items: center;
      gap: 4px;
      padding: 4px 10px;
      background: var(--surface-elevated);
      border: 1px solid var(--border);
      border-radius: var(--radius-sm);
      font-size: 12px;
      font-weight: 600;
      color: var(--text-secondary);
    }
    
    .place-price {
      color: var(--accent-green);
    }
    
    .place-address {
      font-size: 14px;
      color: var(--text-secondary);
      line-height: 1.5;
      margin: 12px 0;
      display: flex;
      align-items: start;
      gap: 8px;
    }
    
    .place-status {
      display: inline-flex;
      align-items: center;
      gap: 6px;
      font-size: 13px;
      font-weight: 700;
      padding: 6px 12px;
      border-radius: var(--radius-full);
      margin-top: 12px;
    }
    
    .place-status.open {
      background: rgba(0,255,148,.1);
      color: var(--accent-green);
      border: 1px solid rgba(0,255,148,.2);
    }
    
    .place-status.closed {
      background: rgba(255,59,92,.1);
      color: var(--accent-red);
      border: 1px solid rgba(255,59,92,.2);
    }
    
    .favorite-btn {
      background: var(--surface-elevated);
      border: 1px solid var(--border);
      width: 44px;
      height: 44px;
      border-radius: var(--radius-full);
      font-size: 20px;
      cursor: pointer;
      transition: all 0.3s var(--ease-spring);
      display: flex;
      align-items: center;
      justify-content: center;
      flex-shrink: 0;
    }
    
    .favorite-btn:hover {
      transform: scale(1.15);
      border-color: var(--brand);
    }
    
    .favorite-btn:active {
      transform: scale(0.9);
    }

    .pharmacy-card {
      background: linear-gradient(135deg, rgba(0,255,148,.1), rgba(0,168,255,.1));
      border: 2px solid var(--accent-green);
    }
    
    .pharmacy-card .place-name {
      color: var(--accent-green);
    }
    
    .pharmacy-day {
      display: inline-flex;
      padding: 6px 12px;
      background: var(--accent-green);
      color: #000;
      border-radius: var(--radius-full);
      font-size: 12px;
      font-weight: 700;
      margin-top: 8px;
    }

    .modal {
      position: fixed;
      inset: 0;
      z-index: 1000;
      background: rgba(0,0,0,.75);
      backdrop-filter: blur(10px);
      display: none;
      align-items: center;
      justify-content: center;
      padding: 20px;
      animation: modalFadeIn 0.3s var(--ease-out);
    }
    
    @keyframes modalFadeIn {
      from { opacity: 0; }
      to { opacity: 1; }
    }
    
    .modal.active {
      display: flex;
    }
    
    .modal-content {
      background: var(--surface);
      border: 1px solid var(--border-strong);
      border-radius: var(--radius-xl);
      width: 100%;
      max-width: 480px;
      max-height: 85vh;
      overflow: hidden;
      animation: modalSlideUp 0.4s var(--ease-out);
      box-shadow: var(--shadow-xl);
    }
    
    @keyframes modalSlideUp {
      from { 
        transform: translateY(40px) scale(0.95);
        opacity: 0;
      }
      to { 
        transform: translateY(0) scale(1);
        opacity: 1;
      }
    }
    
    .modal-header {
      padding: 24px 24px 20px;
      border-bottom: 1px solid var(--border);
      display: flex;
      justify-content: space-between;
      align-items: center;
      background: var(--surface-elevated);
    }
    
    .modal-title {
      font-size: 22px;
      font-weight: 800;
      letter-spacing: -0.5px;
    }
    
    .modal-body {
      padding: 24px;
      overflow-y: auto;
      max-height: calc(85vh - 80px);
    }
    
    .modal-body::-webkit-scrollbar {
      width: 6px;
    }
    
    .detail-section {
      margin-bottom: 24px;
    }
    
    .detail-label {
      font-size: 12px;
      font-weight: 700;
      color: var(--text-tertiary);
      text-transform: uppercase;
      letter-spacing: 1px;
      margin-bottom: 8px;
    }
    
    .detail-value {
      font-size: 15px;
      color: var(--text-primary);
      line-height: 1.6;
    }
    
    .action-buttons {
      display: grid;
      grid-template-columns: repeat(2, 1fr);
      gap: 12px;
      margin-top: 24px;
    }
    
    .action-buttons .btn {
      width: 100%;
    }

    .admin-panel {
      position: fixed;
      bottom: 0;
      left: 0;
      right: 0;
      background: var(--surface);
      border-top: 2px solid var(--brand);
      box-shadow: var(--shadow-xl);
      transform: translateY(100%);
      transition: transform 0.4s var(--ease-out);
      z-index: 999;
      max-height: 85vh;
      overflow-y: auto;
      border-radius: var(--radius-xl) var(--radius-xl) 0 0;
    }
    
    .admin-panel.active {
      transform: translateY(0);
    }
    
    .admin-header {
      padding: 20px 24px;
      background: linear-gradient(135deg, var(--brand), var(--brand-dim));
      color: #000;
      display: flex;
      justify-content: space-between;
      align-items: center;
      border-radius: var(--radius-xl) var(--radius-xl) 0 0;
    }
    
    .admin-header h2 {
      font-size: 20px;
      font-weight: 800;
      letter-spacing: -0.3px;
    }
    
    .admin-body {
      padding: 24px;
      background: var(--bg-secondary);
    }
    
    .admin-tabs {
      display: flex;
      gap: 8px;
      margin-bottom: 20px;
      border-bottom: 1px solid var(--border);
      padding-bottom: 12px;
      overflow-x: auto;
    }
    
    .admin-tab {
      padding: 8px 16px;
      background: transparent;
      border: none;
      border-radius: var(--radius-md);
      font-size: 14px;
      font-weight: 600;
      color: var(--text-secondary);
      cursor: pointer;
      transition: all 0.3s;
      white-space: nowrap;
    }
    
    .admin-tab.active {
      background: var(--surface);
      color: var(--text-primary);
    }
    
    .admin-tab-content {
      display: none;
    }
    
    .admin-tab-content.active {
      display: block;
    }
    
    .form-group {
      margin-bottom: 20px;
    }
    
    .form-label {
      display: block;
      font-size: 13px;
      font-weight: 700;
      margin-bottom: 8px;
      color: var(--text-primary);
      letter-spacing: -0.2px;
    }
    
    .form-note {
      font-size: 12px;
      color: var(--text-tertiary);
      margin-top: 6px;
      font-style: italic;
    }
    
    .admin-list-item {
      background: var(--surface);
      border: 1px solid var(--border);
      padding: 16px;
      border-radius: var(--radius-md);
      margin-bottom: 12px;
      display: flex;
      justify-content: space-between;
      align-items: center;
      gap: 12px;
      transition: all 0.3s;
    }
    
    .admin-list-item:hover {
      border-color: var(--border-strong);
      transform: translateX(4px);
    }
    
    .admin-item-actions {
      display: flex;
      gap: 8px;
      flex-shrink: 0;
    }

    .weekly-schedule {
      display: grid;
      gap: 12px;
    }
    
    .day-input-group {
      background: var(--surface);
      padding: 16px;
      border-radius: var(--radius-md);
      border: 1px solid var(--border);
    }
    
    .day-label {
      font-weight: 700;
      margin-bottom: 12px;
      color: var(--text-primary);
      display: block;
    }

    .toast {
      position: fixed;
      bottom: 24px;
      left: 50%;
      transform: translateX(-50%) translateY(100px);
      background: var(--surface-elevated);
      border: 1px solid var(--border-strong);
      color: var(--text-primary);
      padding: 16px 24px;
      border-radius: var(--radius-full);
      box-shadow: var(--shadow-lg);
      z-index: 9999;
      transition: transform 0.4s var(--ease-out);
      min-width: 280px;
      text-align: center;
      font-weight: 600;
      font-size: 14px;
      backdrop-filter: blur(20px);
    }
    
    .toast.show {
      transform: translateX(-50%) translateY(0);
    }
    
    .toast.success {
      background: var(--accent-green);
      color: #000;
      border-color: var(--accent-green);
      box-shadow: 0 8px 24px rgba(0,255,148,.3);
    }
    
    .toast.error {
      background: var(--accent-red);
      color: #fff;
      border-color: var(--accent-red);
      box-shadow: 0 8px 24px rgba(255,59,92,.3);
    }

    .loading {
      text-align: center;
      padding: 60px 20px;
      color: var(--text-secondary);
    }
    
    .spinner {
      width: 48px;
      height: 48px;
      border: 3px solid var(--surface-elevated);
      border-top-color: var(--brand);
      border-radius: 50%;
      animation: spin 0.8s linear infinite;
      margin: 0 auto 20px;
    }
    
    @keyframes spin {
      to { transform: rotate(360deg); }
    }

    .empty-state {
      text-align: center;
      padding: 80px 20px;
      color: var(--text-tertiary);
    }
    
    .empty-state-icon {
      font-size: 72px;
      margin-bottom: 20px;
      opacity: 0.3;
      filter: grayscale(1);
    }
    
    .empty-state-text {
      font-size: 16px;
      font-weight: 600;
    }

    @media (max-width: 480px) {
      .header-row {
        padding: 14px 16px;
      }
      
      .brand {
        font-size: 20px;
      }
      
      .brand-emoji {
        font-size: 28px;
      }
      
      .search-bar,
      .categories,
      .filters,
      main {
        padding-left: 16px;
        padding-right: 16px;
      }
      
      .place-card {
        padding: 16px;
      }
      
      .action-buttons {
        grid-template-columns: 1fr;
      }
      
      .modal-content {
        border-radius: var(--radius-lg);
      }
    }
  </style>
</head>

<body>
  <div class="container">
    
    <header>
      <div class="header-row">
        <div class="brand" onclick="handleLogoClick()">
          <span class="brand-emoji">🍋</span>
          <span>LemmOn</span>
        </div>
        <div class="header-actions">
          <button class="btn-icon" onclick="toggleTheme()" title="Tema">
            <span id="theme-icon">🌙</span>
          </button>
          <button class="btn-icon" onclick="showFavorites()" title="Favoriler">
            ❤️
          </button>
          <button class="btn-icon" onclick="showMenu()" title="Menü">
            ☰
          </button>
        </div>
      </div>
      
      <div class="search-bar">
        <div class="search-wrapper">
          <input 
            type="text" 
            id="search-input" 
            class="input" 
            placeholder="Mekan ara..."
            oninput="handleSearch()"
          />
          <span class="search-icon">🔍</span>
        </div>
      </div>
      
      <div class="categories" id="categories-container"></div>
      
      <div class="filters">
        <button class="filter-btn" onclick="toggleFilter('district')" id="district-filter-btn">
          📍 İlçe
        </button>
        <button class="filter-btn" onclick="toggleFilter('price')" id="price-filter-btn">
          💰 Fiyat
        </button>
      </div>
    </header>

    <main id="main-content">
      <div class="loading">
        <div class="spinner"></div>
        <div>Mekanlar yükleniyor...</div>
      </div>
    </main>

  </div>

  <!-- DETAIL MODAL -->
  <div class="modal" id="detail-modal">
    <div class="modal-content">
      <div class="modal-header">
        <h2 class="modal-title" id="detail-name">Mekan</h2>
        <button class="btn-icon" onclick="closeDetailModal()">✕</button>
      </div>
      <div class="modal-body" id="detail-body"></div>
    </div>
  </div>

  <!-- FAVORITES MODAL -->
  <div class="modal" id="favorites-modal">
    <div class="modal-content">
      <div class="modal-header">
        <h2 class="modal-title">❤️ Favorilerim</h2>
        <button class="btn-icon" onclick="closeFavoritesModal()">✕</button>
      </div>
      <div class="modal-body" id="favorites-body"></div>
    </div>
  </div>

  <!-- MENU MODAL -->
  <div class="modal" id="menu-modal">
    <div class="modal-content">
      <div class="modal-header">
        <h2 class="modal-title">☰ Menü</h2>
        <button class="btn-icon" onclick="closeMenuModal()">✕</button>
      </div>
      <div class="modal-body">
        <button class="btn btn-secondary" onclick="showPharmacies()" style="width: 100%; margin-bottom: 12px;">
          🏥 Nöbetçi Eczaneler
        </button>
        <button class="btn btn-secondary" onclick="showSupport()" style="width: 100%; margin-bottom: 12px;">
          💬 Destek Talebi
        </button>
        <button class="btn btn-secondary" onclick="showAbout()" style="width: 100%;">
          ℹ️ Hakkında
        </button>
      </div>
    </div>
  </div>

  <!-- PHARMACIES MODAL -->
  <div class="modal" id="pharmacies-modal">
    <div class="modal-content">
      <div class="modal-header">
        <h2 class="modal-title">🏥 Nöbetçi Eczaneler</h2>
        <button class="btn-icon" onclick="closePharmaciesModal()">✕</button>
      </div>
      <div class="modal-body" id="pharmacies-body">
        <div class="loading">
          <div class="spinner"></div>
          <div>Yükleniyor...</div>
        </div>
      </div>
    </div>
  </div>

  <!-- SUPPORT MODAL -->
  <div class="modal" id="support-modal">
    <div class="modal-content">
      <div class="modal-header">
        <h2 class="modal-title">💬 Destek Talebi</h2>
        <button class="btn-icon" onclick="closeSupportModal()">✕</button>
      </div>
      <div class="modal-body">
        <div class="form-group">
          <label class="form-label">İSİM SOYISIM *</label>
          <input type="text" id="support-name" class="input" placeholder="Adınız Soyadınız">
        </div>
        
        <div class="form-group">
          <label class="form-label">E-MAIL *</label>
          <input type="email" id="support-email" class="input" placeholder="ornek@email.com">
          <div class="form-note">⚠️ Email adresinizi doğru yazdığınızdan emin olun. Cevap bu adrese gelecek!</div>
        </div>
        
        <div class="form-group">
          <label class="form-label">KONU *</label>
          <input type="text" id="support-subject" class="input" placeholder="Talep konusu">
        </div>
        
        <div class="form-group">
          <label class="form-label">MESAJ *</label>
          <textarea id="support-message" class="input" rows="5" placeholder="Talebinizi detaylı yazın..."></textarea>
        </div>
        
        <button class="btn btn-primary" onclick="submitSupport()" style="width: 100%;">
          📤 Gönder
        </button>
      </div>
    </div>
  </div>

  <!-- DISTRICT FILTER MODAL -->
  <div class="modal" id="district-filter-modal">
    <div class="modal-content">
      <div class="modal-header">
        <h2 class="modal-title">📍 İlçe Seç</h2>
        <button class="btn-icon" onclick="closeDistrictFilterModal()">✕</button>
      </div>
      <div class="modal-body" id="district-filter-body"></div>
    </div>
  </div>

  <!-- PRICE FILTER MODAL -->
  <div class="modal" id="price-filter-modal">
    <div class="modal-content">
      <div class="modal-header">
        <h2 class="modal-title">💰 Fiyat Aralığı</h2>
        <button class="btn-icon" onclick="closePriceFilterModal()">✕</button>
      </div>
      <div class="modal-body">
        <button class="btn btn-secondary" onclick="selectPriceFilter('all')" style="width: 100%; margin-bottom: 12px;">
          Tümü
        </button>
        <button class="btn btn-secondary" onclick="selectPriceFilter('€')" style="width: 100%; margin-bottom: 12px;">
          € Ekonomik
        </button>
        <button class="btn btn-secondary" onclick="selectPriceFilter('€€')" style="width: 100%; margin-bottom: 12px;">
          €€ Orta
        </button>
        <button class="btn btn-secondary" onclick="selectPriceFilter('€€€')" style="width: 100%;">
          €€€ Lüks
        </button>
      </div>
    </div>
  </div>

  <!-- ADMIN PIN MODAL -->
  <div class="modal" id="admin-pin-modal">
    <div class="modal-content">
      <div class="modal-header">
        <h2 class="modal-title">🔑 Admin Girişi</h2>
        <button class="btn-icon" onclick="closeAdminPinModal()">✕</button>
      </div>
      <div class="modal-body">
        <div class="form-group">
          <label class="form-label">PIN KODU</label>
          <input 
            type="password" 
            id="admin-pin-input" 
            class="input" 
            placeholder="4 haneli PIN"
            maxlength="4"
            onkeypress="if(event.key==='Enter') checkAdminPin()"
          />
        </div>
        <button class="btn btn-primary" onclick="checkAdminPin()" style="width: 100%;">
          Giriş Yap
        </button>
        <p style="margin-top: 16px; font-size: 13px; color: var(--text-tertiary); text-align: center;">
          Varsayılan PIN: 1234
        </p>
      </div>
    </div>
  </div>

  <!-- ADMIN PANEL -->
  <div class="admin-panel" id="admin-panel">
    <div class="admin-header">
      <h2>⚙️ Admin Panel</h2>
      <button class="btn-icon" onclick="closeAdminPanel()" style="color: #000; border-color: rgba(0,0,0,.2);">✕</button>
    </div>
    <div class="admin-body">
      
      <!-- TABS -->
      <div class="admin-tabs">
        <button class="admin-tab active" onclick="switchAdminTab('places')">📍 Mekanlar</button>
        <button class="admin-tab" onclick="switchAdminTab('categories')">🏷️ Kategoriler</button>
        <button class="admin-tab" onclick="switchAdminTab('pharmacies')">🏥 Eczaneler</button>
        <button class="admin-tab" onclick="switchAdminTab('support')">💬 Talepler</button>
        <button class="admin-tab" onclick="switchAdminTab('settings')">⚙️ Ayarlar</button>
      </div>
      
      <!-- PLACES TAB -->
      <div class="admin-tab-content active" id="admin-places-tab">
        <div style="background: var(--surface); padding: 20px; border-radius: var(--radius-lg); margin-bottom: 24px; border: 1px solid var(--border);">
          <h3 style="margin-bottom: 20px; font-weight: 800; font-size: 18px;">📍 Mekan Ekle/Düzenle</h3>
          
          <input type="hidden" id="edit-place-id" value="">
          
          <div class="form-group">
            <label class="form-label">MEKAN ADI *</label>
            <input type="text" id="place-name" class="input" placeholder="Örn: Starbucks">
          </div>
          
          <div class="form-group">
            <label class="form-label">KATEGORİ *</label>
            <select id="place-category" class="input">
              <option value="">Seçiniz</option>
              <option value="cafe">☕ Cafe</option>
              <option value="restaurant">🍽️ Restoran</option>
              <option value="shopping">🛍️ Alışveriş</option>
              <option value="entertainment">🎮 Eğlence</option>
              <option value="health">🏥 Sağlık</option>
              <option value="education">📚 Eğitim</option>
              <option value="hotel">🏨 Konaklama</option>
              <option value="other">📌 Diğer</option>
            </select>
          </div>
          
          <div class="form-group">
            <label class="form-label">İLÇE *</label>
            <select id="place-district" class="input"></select>
          </div>
          
          <div class="form-group">
            <label class="form-label">FİYAT ARALIĞI</label>
            <select id="place-price" class="input">
              <option value="">Seçiniz</option>
              <option value="€">€ Ekonomik</option>
              <option value="€€">€€ Orta</option>
              <option value="€€€">€€€ Lüks</option>
            </select>
          </div>
          
          <div class="form-group">
            <label class="form-label">ADRES *</label>
            <textarea id="place-address" class="input" placeholder="Tam adres"></textarea>
          </div>
          
          <div class="form-group">
            <label class="form-label">TELEFON</label>
            <input type="tel" id="place-phone" class="input" placeholder="0324 123 45 67">
          </div>
          
          <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 12px;">
            <div class="form-group">
              <label class="form-label">ENLEM</label>
              <input type="number" step="0.000001" id="place-lat" class="input" placeholder="36.812">
            </div>
            
            <div class="form-group">
              <label class="form-label">BOYLAM</label>
              <input type="number" step="0.000001" id="place-lng" class="input" placeholder="34.641">
            </div>
          </div>
          
          <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 12px;">
            <div class="form-group">
              <label class="form-label">AÇILIŞ</label>
              <input type="time" id="place-open" class="input" value="09:00">
            </div>
            
            <div class="form-group">
              <label class="form-label">KAPANIŞ</label>
              <input type="time" id="place-close" class="input" value="22:00">
            </div>
          </div>
          
          <div class="form-group">
            <label class="form-label">AÇIKLAMA</label>
            <textarea id="place-description" class="input" placeholder="Mekan hakkında bilgi"></textarea>
          </div>
          
          <div style="display: flex; gap: 12px;">
            <button class="btn btn-primary" onclick="savePlaceData()" style="flex: 1;">
              💾 Kaydet
            </button>
            <button class="btn btn-secondary" onclick="resetPlaceForm()">
              🔄 Temizle
            </button>
          </div>
        </div>
        
        <div>
          <h3 style="margin-bottom: 16px; font-weight: 800; font-size: 18px;">📋 Mekanlar</h3>
          <div id="admin-places-list"></div>
        </div>
      </div>
      
      <!-- KATEGORİLER TAB -->
      <div class="admin-tab-content" id="admin-categories-tab">
        <div style="background: var(--surface); padding: 20px; border-radius: var(--radius-lg); margin-bottom: 24px; border: 1px solid var(--border);">
          <h3 style="margin-bottom: 20px; font-weight: 800; font-size: 18px;">🏷️ Yeni Kategori Ekle</h3>
          
          <div class="form-group">
            <label class="form-label">KATEGORİ ADI *</label>
            <input type="text" id="new-category-name" class="input" placeholder="Örn: Spor Salonları">
          </div>
          
          <div class="form-group">
            <label class="form-label">İKON (EMOJİ) *</label>
            <input type="text" id="new-category-icon" class="input" placeholder="Örn: 💪" maxlength="2">
          </div>
          
          <div class="form-group">
            <label class="form-label">KATEGORİ ID *</label>
            <input type="text" id="new-category-id" class="input" placeholder="Örn: gym">
            <div class="form-note">İngilizce, küçük harf, boşluksuz</div>
          </div>
          
          <button class="btn btn-primary" onclick="addNewCategory()" style="width: 100%;">
            ➕ Kategori Ekle
          </button>
        </div>
        
        <div>
          <h3 style="margin-bottom: 16px; font-weight: 800; font-size: 18px;">📋 Kategoriler</h3>
          <div id="admin-categories-list"></div>
        </div>
      </div>
      
      <!-- PHARMACIES TAB -->
      <div class="admin-tab-content" id="admin-pharmacies-tab">
        <div style="background: var(--surface); padding: 20px; border-radius: var(--radius-lg); margin-bottom: 24px; border: 1px solid var(--border);">
          <h3 style="margin-bottom: 20px; font-weight: 800; font-size: 18px;">🏥 Haftalık Eczane Ekle</h3>
          
          <div class="form-group">
            <label class="form-label">HAFTA BAŞLANGIÇ TARİHİ *</label>
            <input type="date" id="pharmacy-week-start" class="input">
            <div class="form-note">Bu haftanın pazartesi gününü seçin</div>
          </div>
          
          <div class="weekly-schedule">
            <div class="day-input-group">
              <label class="day-label">📅 PAZARTESİ</label>
              <input type="text" id="pharmacy-monday-name" class="input" placeholder="Eczane adı" style="margin-bottom: 8px;">
              <input type="text" id="pharmacy-monday-address" class="input" placeholder="Adres" style="margin-bottom: 8px;">
              <input type="tel" id="pharmacy-monday-phone" class="input" placeholder="Telefon">
            </div>
            
            <div class="day-input-group">
              <label class="day-label">📅 SALI</label>
              <input type="text" id="pharmacy-tuesday-name" class="input" placeholder="Eczane adı" style="margin-bottom: 8px;">
              <input type="text" id="pharmacy-tuesday-address" class="input" placeholder="Adres" style="margin-bottom: 8px;">
              <input type="tel" id="pharmacy-tuesday-phone" class="input" placeholder="Telefon">
            </div>
            
            <div class="day-input-group">
              <label class="day-label">📅 ÇARŞAMBA</label>
              <input type="text" id="pharmacy-wednesday-name" class="input" placeholder="Eczane adı" style="margin-bottom: 8px;">
              <input type="text" id="pharmacy-wednesday-address" class="input" placeholder="Adres" style="margin-bottom: 8px;">
              <input type="tel" id="pharmacy-wednesday-phone" class="input" placeholder="Telefon">
            </div>
            
            <div class="day-input-group">
              <label class="day-label">📅 PERŞEMBE</label>
              <input type="text" id="pharmacy-thursday-name" class="input" placeholder="Eczane adı" style="margin-bottom: 8px;">
              <input type="text" id="pharmacy-thursday-address" class="input" placeholder="Adres" style="margin-bottom: 8px;">
              <input type="tel" id="pharmacy-thursday-phone" class="input" placeholder="Telefon">
            </div>
            
            <div class="day-input-group">
              <label class="day-label">📅 CUMA</label>
              <input type="text" id="pharmacy-friday-name" class="input" placeholder="Eczane adı" style="margin-bottom: 8px;">
              <input type="text" id="pharmacy-friday-address" class="input" placeholder="Adres" style="margin-bottom: 8px;">
              <input type="tel" id="pharmacy-friday-phone" class="input" placeholder="Telefon">
            </div>
            
            <div class="day-input-group">
              <label class="day-label">📅 CUMARTESİ</label>
              <input type="text" id="pharmacy-saturday-name" class="input" placeholder="Eczane adı" style="margin-bottom: 8px;">
              <input type="text" id="pharmacy-saturday-address" class="input" placeholder="Adres" style="margin-bottom: 8px;">
              <input type="tel" id="pharmacy-saturday-phone" class="input" placeholder="Telefon">
            </div>
            
            <div class="day-input-group">
              <label class="day-label">📅 PAZAR</label>
              <input type="text" id="pharmacy-sunday-name" class="input" placeholder="Eczane adı" style="margin-bottom: 8px;">
              <input type="text" id="pharmacy-sunday-address" class="input" placeholder="Adres" style="margin-bottom: 8px;">
              <input type="tel" id="pharmacy-sunday-phone" class="input" placeholder="Telefon">
            </div>
          </div>
          
          <button class="btn btn-primary" onclick="saveWeeklyPharmacies()" style="width: 100%; margin-top: 20px;">
            💾 Haftalık Kaydet
          </button>
        </div>
        
        <div>
          <h3 style="margin-bottom: 16px; font-weight: 800; font-size: 18px;">📋 Eczane Haftaları</h3>
          <div id="admin-pharmacies-list"></div>
        </div>
      </div>
      
      <!-- SUPPORT TAB -->
      <div class="admin-tab-content" id="admin-support-tab">
        <div>
          <h3 style="margin-bottom: 16px; font-weight: 800; font-size: 18px;">📬 Destek Talepleri</h3>
          <div id="admin-support-list"></div>
        </div>
      </div>
      
      <!-- SETTINGS TAB -->
      <div class="admin-tab-content" id="admin-settings-tab">
        <!-- Hakkımda Düzenleme -->
        <div style="background: var(--surface); padding: 20px; border-radius: var(--radius-lg); margin-bottom: 24px; border: 1px solid var(--border);">
          <h3 style="margin-bottom: 20px; font-weight: 800; font-size: 18px;">ℹ️ Hakkımda Bölümü</h3>
          
          <div class="form-group">
            <label class="form-label">BAŞLIK</label>
            <input type="text" id="about-title" class="input" placeholder="LemmOn Mersin">
          </div>
          
          <div class="form-group">
            <label class="form-label">ALT BAŞLIK</label>
            <input type="text" id="about-subtitle" class="input" placeholder="Mersin Şehir Rehberi">
          </div>
          
          <div class="form-group">
            <label class="form-label">AÇIKLAMA</label>
            <textarea id="about-description" class="input" rows="4" placeholder="Mersin'deki en iyi mekanları keşfet..."></textarea>
          </div>
          
          <div class="form-group">
            <label class="form-label">VERSİYON</label>
            <input type="text" id="about-version" class="input" placeholder="V2.0 • 2025">
          </div>
          
          <button class="btn btn-primary" onclick="saveAboutData()" style="width: 100%;">
            💾 Kaydet
          </button>
        </div>
        
        <!-- Yedekleme -->
        <div style="background: var(--surface); padding: 20px; border-radius: var(--radius-lg); border: 1px solid var(--border);">
          <h3 style="margin-bottom: 20px; font-weight: 800; font-size: 18px;">💾 Yedekleme</h3>
          
          <button class="btn btn-secondary" onclick="exportBackup()" style="width: 100%; margin-bottom: 12px;">
            📥 Yedek Al
          </button>
          
          <button class="btn btn-secondary" onclick="importBackup()" style="width: 100%;">
            📤 Yedek Yükle
          </button>
          
          <div class="form-note" style="margin-top: 12px;">
            💡 Yedek dosyası mekanları ve favorileri içerir
          </div>
        </div>
      </div>
      
    </div>
  </div>

  <!-- ABOUT MODAL -->
  <div class="modal" id="about-modal">
    <div class="modal-content">
      <div class="modal-header">
        <h2 class="modal-title">ℹ️ Hakkında</h2>
        <button class="btn-icon" onclick="closeAboutModal()">✕</button>
      </div>
      <div class="modal-body" id="about-modal-body">
        <div style="text-align: center; padding: 20px 0;">
          <div style="font-size: 80px; margin-bottom: 20px; filter: drop-shadow(0 0 20px rgba(255,229,0,.4));">🍋</div>
          <h2 style="margin-bottom: 12px; font-size: 28px; font-weight: 800; letter-spacing: -0.5px;">LemmOn Mersin</h2>
          <p style="color: var(--text-secondary); margin-bottom: 24px; font-size: 16px;">Mersin Şehir Rehberi</p>
          <p style="font-size: 15px; line-height: 1.7; color: var(--text-secondary);">
            Mersin'deki en iyi mekanları keşfet! Cafeler, restoranlar, alışveriş merkezleri ve daha fazlası...
          </p>
          <p style="margin-top: 32px; font-size: 13px; color: var(--text-tertiary); font-weight: 600;">
            V2.0 • 2025
          </p>
        </div>
      </div>
    </div>
  </div>

  <!-- JAVASCRIPT -->
  <script>
    // Firebase
    const firebaseConfig = {
      apiKey: "AIzaSyA-q76A-JU1w6KigjqZuU-YDywKDBp3KSw",
      authDomain: "lemmon-2e548.firebaseapp.com",
      projectId: "lemmon-2e548",
      storageBucket: "lemmon-2e548.firebasestorage.app",
      messagingSenderId: "704438411759",
      appId: "1:704438411759:web:63de3a656b2067feccd61a"
    };
    
    firebase.initializeApp(firebaseConfig);
    const db = firebase.firestore();
    
    // Globals
    let allPlaces = [];
    let filteredPlaces = [];
    let currentCategory = 'all';
    let currentDistrict = 'all';
    let currentPrice = 'all';
    let favorites = [];
    let currentDetailPlace = null;
    let isAdminMode = false;
    let logoClickCount = 0;
    let logoClickTimer = null;
    let currentAdminTab = 'places';
    
    let categories = [
      { id: 'all', name: 'Tümü', icon: '🌟' },
      { id: 'cafe', name: 'Cafe', icon: '☕' },
      { id: 'restaurant', name: 'Restoran', icon: '🍽️' },
      { id: 'shopping', name: 'Alışveriş', icon: '🛍️' },
      { id: 'entertainment', name: 'Eğlence', icon: '🎮' },
      { id: 'health', name: 'Sağlık', icon: '🏥' },
      { id: 'education', name: 'Eğitim', icon: '📚' },
      { id: 'hotel', name: 'Konaklama', icon: '🏨' },
      { id: 'other', name: 'Diğer', icon: '📌' }
    ];
    
    const districts = [
      'Akdeniz', 'Mezitli', 'Toroslar', 'Yenişehir',
      'Anamur', 'Aydıncık', 'Bozyazı', 'Çamlıyayla',
      'Erdemli', 'Gülnar', 'Mut', 'Silifke', 'Tarsus'
    ];
    
    const dayNames = {
      monday: 'Pazartesi',
      tuesday: 'Salı',
      wednesday: 'Çarşamba',
      thursday: 'Perşembe',
      friday: 'Cuma',
      saturday: 'Cumartesi',
      sunday: 'Pazar'
    };
    
    // Logo Click
    function handleLogoClick() {
      logoClickCount++;
      if (logoClickTimer) clearTimeout(logoClickTimer);
      logoClickTimer = setTimeout(() => { logoClickCount = 0; }, 2000);
      
      if (logoClickCount === 17) {
        logoClickCount = 0;
        clearTimeout(logoClickTimer);
        showAdminLogin();
        showToast('🔓 Gizli admin girişi!', 'success');
      }
      
      if (logoClickCount >= 10 && logoClickCount < 17) {
        console.log(`🔑 ${17 - logoClickCount} tıklama kaldı...`);
      }
    }
    
    // Initialize
    document.addEventListener('DOMContentLoaded', () => {
      initializeApp();
    });
    
    async function initializeApp() {
      loadTheme();
      await loadCategoriesFromFirebase();
      loadFavorites();
      populateDistrictSelect();
      await loadPlaces();
      console.log('✅ LemmOn hazır!');
    }
    
    // Theme
    function loadTheme() {
      const savedTheme = localStorage.getItem('theme') || 'dark';
      document.documentElement.setAttribute('data-theme', savedTheme);
      updateThemeIcon(savedTheme);
    }
    
    function toggleTheme() {
      const currentTheme = document.documentElement.getAttribute('data-theme');
      const newTheme = currentTheme === 'dark' ? 'light' : 'dark';
      document.documentElement.setAttribute('data-theme', newTheme);
      localStorage.setItem('theme', newTheme);
      updateThemeIcon(newTheme);
      showToast(`${newTheme === 'dark' ? '🌙' : '☀️'} Tema değişti`);
    }
    
    function updateThemeIcon(theme) {
      document.getElementById('theme-icon').textContent = theme === 'dark' ? '🌙' : '☀️';
    }
    
    // Categories - Firebase'den yükleme
    async function loadCategoriesFromFirebase() {
      try {
        const snapshot = await db.collection('categories').get();
        if (!snapshot.empty) {
          categories = [{ id: 'all', name: 'Tümü', icon: '🌟' }];
          snapshot.forEach(doc => {
            const data = doc.data();
            categories.push({
              id: data.id,
              name: data.name,
              icon: data.icon
            });
          });
          console.log(`✅ ${categories.length} kategori yüklendi`);
        }
      } catch (error) {
        console.error('Kategori yükleme hatası:', error);
      }
      loadCategories();
    }
    
    function loadCategories() {
      const container = document.getElementById('categories-container');
      container.innerHTML = '';
      categories.forEach(cat => {
        const chip = document.createElement('span');
        chip.className = 'category-chip';
        if (cat.id === currentCategory) chip.classList.add('active');
        chip.innerHTML = `${cat.icon} ${cat.name}`;
        chip.onclick = () => selectCategory(cat.id);
        container.appendChild(chip);
      });
    }
    
    function selectCategory(categoryId) {
      currentCategory = categoryId;
      loadCategories();
      filterPlaces();
    }
    
    // Yeni kategori ekleme
    async function addNewCategory() {
      const name = document.getElementById('new-category-name').value.trim();
      const icon = document.getElementById('new-category-icon').value.trim();
      const id = document.getElementById('new-category-id').value.trim();
      
      if (!name) { showToast('Kategori adı gerekli!', 'error'); return; }
      if (!icon) { showToast('İkon gerekli!', 'error'); return; }
      if (!id) { showToast('Kategori ID gerekli!', 'error'); return; }
      
      // ID kontrolü
      if (categories.find(c => c.id === id)) {
        showToast('Bu ID zaten kullanılıyor!', 'error');
        return;
      }
      
      try {
        await db.collection('categories').add({ id, name, icon });
        showToast('Kategori eklendi!', 'success');
        
        // Form temizle
        document.getElementById('new-category-name').value = '';
        document.getElementById('new-category-icon').value = '';
        document.getElementById('new-category-id').value = '';
        
        // Kategorileri yeniden yükle
        await loadCategoriesFromFirebase();
        loadAdminCategoriesList();
      } catch (error) {
        console.error('Hata:', error);
        showToast('Eklenemedi!', 'error');
      }
    }
    
    // Admin kategoriler listesi
    function loadAdminCategoriesList() {
      const container = document.getElementById('admin-categories-list');
      // "Tümü" kategorisini hariç tut
      const userCategories = categories.filter(c => c.id !== 'all');
      
      if (userCategories.length === 0) {
        container.innerHTML = '<div class="empty-state-text">Henüz kategori yok</div>';
        return;
      }
      
      container.innerHTML = '';
      userCategories.forEach(cat => {
        const item = document.createElement('div');
        item.className = 'admin-list-item';
        item.innerHTML = `
          <div>
            <div style="font-weight: 700; margin-bottom: 6px; font-size: 15px;">${cat.icon} ${cat.name}</div>
            <div style="font-size: 13px; color: var(--text-secondary);">ID: ${cat.id}</div>
          </div>
          <div class="admin-item-actions">
            <button class="btn btn-secondary" onclick="deleteCategory('${cat.id}')" style="padding: 8px 14px; font-size: 13px;">🗑️</button>
          </div>
        `;
        container.appendChild(item);
      });
    }
    
    // Kategori silme
    async function deleteCategory(categoryId) {
      if (!confirm('Bu kategoriyi silmek istediğinizden emin misiniz?')) return;
      
      try {
        // Firebase'den sil
        const snapshot = await db.collection('categories').where('id', '==', categoryId).get();
        snapshot.forEach(doc => doc.ref.delete());
        
        showToast('Kategori silindi!', 'success');
        
        // Kategorileri yeniden yükle
        await loadCategoriesFromFirebase();
        loadAdminCategoriesList();
      } catch (error) {
        console.error('Hata:', error);
        showToast('Silinemedi!', 'error');
      }
    }
    
    // Districts
    function populateDistrictSelect() {
      const select = document.getElementById('place-district');
      select.innerHTML = '<option value="">Seçiniz</option>';
      districts.forEach(d => {
        const opt = document.createElement('option');
        opt.value = d;
        opt.textContent = d;
        select.appendChild(opt);
      });
    }
    
    function toggleFilter(type) {
      if (type === 'district') {
        showDistrictFilter();
      } else if (type === 'price') {
        showPriceFilter();
      }
    }
    
    function showDistrictFilter() {
      const modal = document.getElementById('district-filter-modal');
      const body = document.getElementById('district-filter-body');
      body.innerHTML = `
        <button class="btn btn-secondary" onclick="selectDistrictFilter('all')" style="width: 100%; margin-bottom: 12px;">
          Tüm İlçeler
        </button>
      `;
      districts.forEach(d => {
        const btn = document.createElement('button');
        btn.className = 'btn btn-secondary';
        btn.style.width = '100%';
        btn.style.marginBottom = '12px';
        btn.textContent = d;
        btn.onclick = () => selectDistrictFilter(d);
        body.appendChild(btn);
      });
      modal.classList.add('active');
    }
    
    function closeDistrictFilterModal() {
      document.getElementById('district-filter-modal').classList.remove('active');
    }
    
    function selectDistrictFilter(district) {
      currentDistrict = district;
      const btn = document.getElementById('district-filter-btn');
      if (district === 'all') {
        btn.textContent = '📍 İlçe';
        btn.classList.remove('active');
      } else {
        btn.textContent = '📍 ' + district;
        btn.classList.add('active');
      }
      closeDistrictFilterModal();
      filterPlaces();
    }
    
    function showPriceFilter() {
      document.getElementById('price-filter-modal').classList.add('active');
    }
    
    function closePriceFilterModal() {
      document.getElementById('price-filter-modal').classList.remove('active');
    }
    
    function selectPriceFilter(price) {
      currentPrice = price;
      const btn = document.getElementById('price-filter-btn');
      if (price === 'all') {
        btn.textContent = '💰 Fiyat';
        btn.classList.remove('active');
      } else {
        btn.textContent = '💰 ' + price;
        btn.classList.add('active');
      }
      closePriceFilterModal();
      filterPlaces();
    }
    
    // Places
    async function loadPlaces() {
      try {
        const snapshot = await db.collection('places').get();
        allPlaces = [];
        snapshot.forEach(doc => {
          allPlaces.push({ id: doc.id, ...doc.data() });
        });
        console.log(`📍 ${allPlaces.length} mekan yüklendi`);
        filterPlaces();
      } catch (error) {
        console.error('❌ Hata:', error);
        showToast('Mekanlar yüklenemedi!', 'error');
        showEmptyState('Hata oluştu 😞');
      }
    }
    
    function filterPlaces() {
      filteredPlaces = [...allPlaces];
      
      // Category filter
      if (currentCategory !== 'all') {
        filteredPlaces = filteredPlaces.filter(p => p.category === currentCategory);
      }
      
      // District filter
      if (currentDistrict !== 'all') {
        filteredPlaces = filteredPlaces.filter(p => p.district === currentDistrict);
      }
      
      // Price filter
      if (currentPrice !== 'all') {
        filteredPlaces = filteredPlaces.filter(p => p.priceRange === currentPrice);
      }
      
      // Search filter
      const searchTerm = document.getElementById('search-input').value.toLowerCase().trim();
      if (searchTerm) {
        filteredPlaces = filteredPlaces.filter(p => 
          p.name.toLowerCase().includes(searchTerm) ||
          (p.address && p.address.toLowerCase().includes(searchTerm)) ||
          (p.description && p.description.toLowerCase().includes(searchTerm))
        );
      }
      
      displayPlaces();
    }
    
    function displayPlaces() {
      const container = document.getElementById('main-content');
      if (filteredPlaces.length === 0) {
        showEmptyState('Mekan bulunamadı 🔍');
        return;
      }
      container.innerHTML = '';
      filteredPlaces.forEach(place => {
        container.appendChild(createPlaceCard(place));
      });
    }
    
    function createPlaceCard(place) {
      const card = document.createElement('div');
      card.className = 'place-card';
      card.onclick = () => showPlaceDetail(place);
      
      const categoryInfo = categories.find(c => c.id === place.category) || { icon: '📌', name: 'Diğer' };
      const isFav = isFavorite(place.id);
      const status = getPlaceStatus(place);
      
      card.innerHTML = `
        <div class="place-header">
          <div>
            <div class="place-name">${escapeHtml(place.name)}</div>
            <div class="place-meta">
              <span class="place-category">${categoryInfo.icon} ${categoryInfo.name}</span>
              ${place.district ? `<span class="place-district">📍 ${place.district}</span>` : ''}
              ${place.priceRange ? `<span class="place-price">${place.priceRange}</span>` : ''}
            </div>
          </div>
          <button class="favorite-btn" onclick="event.stopPropagation(); toggleFavorite('${place.id}')">
            ${isFav ? '❤️' : '🤍'}
          </button>
        </div>
        ${place.address ? `<div class="place-address"><span style="opacity: 0.6;">📍</span> ${escapeHtml(place.address)}</div>` : ''}
        ${status ? `<div class="place-status ${status.class}">${status.icon} ${status.text}</div>` : ''}
      `;
      return card;
    }
    
    // Detail
    function showPlaceDetail(place) {
      currentDetailPlace = place;
      const modal = document.getElementById('detail-modal');
      const nameEl = document.getElementById('detail-name');
      const bodyEl = document.getElementById('detail-body');
      
      const categoryInfo = categories.find(c => c.id === place.category) || { icon: '📌', name: 'Diğer' };
      const status = getPlaceStatus(place);
      const isFav = isFavorite(place.id);
      
      nameEl.textContent = place.name;
      
      bodyEl.innerHTML = `
        <div class="detail-section">
          <div class="detail-label">KATEGORİ</div>
          <div class="detail-value">${categoryInfo.icon} ${categoryInfo.name}</div>
        </div>
        ${place.district ? `
          <div class="detail-section">
            <div class="detail-label">İLÇE</div>
            <div class="detail-value">📍 ${place.district}</div>
          </div>
        ` : ''}
        ${place.priceRange ? `
          <div class="detail-section">
            <div class="detail-label">FİYAT ARALIĞI</div>
            <div class="detail-value">💰 ${place.priceRange}</div>
          </div>
        ` : ''}
        ${place.address ? `
          <div class="detail-section">
            <div class="detail-label">ADRES</div>
            <div class="detail-value">📍 ${escapeHtml(place.address)}</div>
          </div>
        ` : ''}
        ${place.phone ? `
          <div class="detail-section">
            <div class="detail-label">TELEFON</div>
            <div class="detail-value">📞 ${escapeHtml(place.phone)}</div>
          </div>
        ` : ''}
        ${place.openTime && place.closeTime ? `
          <div class="detail-section">
            <div class="detail-label">ÇALIŞMA SAATLERİ</div>
            <div class="detail-value">🕐 ${place.openTime} - ${place.closeTime}</div>
            ${status ? `<div class="place-status ${status.class}" style="margin-top: 12px;">${status.icon} ${status.text}</div>` : ''}
          </div>
        ` : ''}
        ${place.description ? `
          <div class="detail-section">
            <div class="detail-label">AÇIKLAMA</div>
            <div class="detail-value">${escapeHtml(place.description)}</div>
          </div>
        ` : ''}
        <div class="action-buttons">
          <button class="btn btn-secondary" onclick="toggleFavoriteFromDetail()">
            ${isFav ? '💔' : '❤️'} ${isFav ? 'Çıkar' : 'Favoriye Ekle'}
          </button>
          ${place.latitude && place.longitude ? `
            <button class="btn btn-primary" onclick="openInMaps()">
              🗺️ Haritada Aç
            </button>
          ` : ''}
          ${place.phone ? `
            <button class="btn btn-secondary" onclick="callPlace()">
              📞 Ara
            </button>
          ` : ''}
          <button class="btn btn-secondary" onclick="sharePlace()">
            🔗 Paylaş
          </button>
        </div>
      `;
      
      modal.classList.add('active');
    }
    
    function closeDetailModal() {
      document.getElementById('detail-modal').classList.remove('active');
      currentDetailPlace = null;
    }
    
    function toggleFavoriteFromDetail() {
      if (currentDetailPlace) {
        toggleFavorite(currentDetailPlace.id);
        showPlaceDetail(currentDetailPlace);
      }
    }
    
    function openInMaps() {
      if (currentDetailPlace && currentDetailPlace.latitude && currentDetailPlace.longitude) {
        window.open(`https://www.google.com/maps?q=${currentDetailPlace.latitude},${currentDetailPlace.longitude}`, '_blank');
      }
    }
    
    function callPlace() {
      if (currentDetailPlace && currentDetailPlace.phone) {
        window.location.href = `tel:${currentDetailPlace.phone}`;
      }
    }
    
    function sharePlace() {
      if (currentDetailPlace) {
        const text = `${currentDetailPlace.name} - LemmOn Mersin`;
        if (navigator.share) {
          navigator.share({ title: text, url: window.location.href }).catch(() => {});
        } else {
          navigator.clipboard.writeText(window.location.href)
            .then(() => showToast('Link kopyalandı!', 'success'))
            .catch(() => showToast('Kopyalanamadı', 'error'));
        }
      }
    }
    
    // Favorites
    function loadFavorites() {
      const saved = localStorage.getItem('favorites');
      favorites = saved ? JSON.parse(saved) : [];
    }
    
    function saveFavoritesToStorage() {
      localStorage.setItem('favorites', JSON.stringify(favorites));
    }
    
    function isFavorite(placeId) {
      return favorites.includes(placeId);
    }
    
    function toggleFavorite(placeId) {
      if (isFavorite(placeId)) {
        favorites = favorites.filter(id => id !== placeId);
        showToast('Favorilerden çıkarıldı', 'success');
      } else {
        favorites.push(placeId);
        showToast('Favorilere eklendi!', 'success');
      }
      saveFavoritesToStorage();
      filterPlaces();
    }
    
    function showFavorites() {
      const modal = document.getElementById('favorites-modal');
      const body = document.getElementById('favorites-body');
      if (favorites.length === 0) {
        body.innerHTML = '<div class="empty-state"><div class="empty-state-icon">❤️</div><div class="empty-state-text">Henüz favori mekan yok</div></div>';
      } else {
        const favPlaces = allPlaces.filter(p => favorites.includes(p.id));
        body.innerHTML = '';
        favPlaces.forEach(place => {
          body.appendChild(createPlaceCard(place));
        });
      }
      modal.classList.add('active');
    }
    
    function closeFavoritesModal() {
      document.getElementById('favorites-modal').classList.remove('active');
    }
    
    // Search
    function handleSearch() {
      filterPlaces();
    }
    
    // Menu
    function showMenu() {
      document.getElementById('menu-modal').classList.add('active');
    }
    
    function closeMenuModal() {
      document.getElementById('menu-modal').classList.remove('active');
    }
    
    async function showAbout() {
      closeMenuModal();
      const modal = document.getElementById('about-modal');
      const body = document.getElementById('about-modal-body');
      
      // Firebase'den çek
      const aboutData = await loadAboutDataForDisplay();
      
      body.innerHTML = `
        <div style="text-align: center; padding: 20px 0;">
          <div style="font-size: 80px; margin-bottom: 20px; filter: drop-shadow(0 0 20px rgba(255,229,0,.4));">🍋</div>
          <h2 style="margin-bottom: 12px; font-size: 28px; font-weight: 800; letter-spacing: -0.5px;">${escapeHtml(aboutData.title)}</h2>
          <p style="color: var(--text-secondary); margin-bottom: 24px; font-size: 16px;">${escapeHtml(aboutData.subtitle)}</p>
          <p style="font-size: 15px; line-height: 1.7; color: var(--text-secondary);">
            ${escapeHtml(aboutData.description)}
          </p>
          <p style="margin-top: 32px; font-size: 13px; color: var(--text-tertiary); font-weight: 600;">
            ${escapeHtml(aboutData.version)}
          </p>
        </div>
      `;
      
      modal.classList.add('active');
    }
    
    function closeAboutModal() {
      document.getElementById('about-modal').classList.remove('active');
    }
    
    async function loadAboutDataForDisplay() {
      try {
        const doc = await db.collection('settings').doc('about').get();
        if (doc.exists) {
          return doc.data();
        }
      } catch (error) {
        console.error('Hata:', error);
      }
      
      // Default değerler
      return {
        title: 'LemmOn Mersin',
        subtitle: 'Mersin Şehir Rehberi',
        description: 'Mersin\'deki en iyi mekanları keşfet! Cafeler, restoranlar, alışveriş merkezleri ve daha fazlası...',
        version: 'V2.0 • 2025'
      };
    }
    
    // Pharmacies
    async function showPharmacies() {
      closeMenuModal();
      const modal = document.getElementById('pharmacies-modal');
      const body = document.getElementById('pharmacies-body');
      modal.classList.add('active');
      
      try {
        const snapshot = await db.collection('pharmacies').orderBy('weekStart', 'desc').limit(1).get();
        
        if (snapshot.empty) {
          body.innerHTML = '<div class="empty-state"><div class="empty-state-icon">🏥</div><div class="empty-state-text">Henüz nöbetçi eczane eklenmemiş</div></div>';
          return;
        }
        
        const weekData = snapshot.docs[0].data();
        const today = new Date().getDay(); // 0=Pazar, 1=Pazartesi
        const dayKeys = ['sunday', 'monday', 'tuesday', 'wednesday', 'thursday', 'friday', 'saturday'];
        const todayKey = dayKeys[today];
        
        body.innerHTML = '<h3 style="margin-bottom: 20px; font-weight: 800;">Bu Hafta</h3>';
        
        dayKeys.forEach((key, index) => {
          const dayData = weekData[key];
          if (dayData && dayData.name) {
            const isToday = key === todayKey;
            const card = document.createElement('div');
            card.className = 'place-card pharmacy-card';
            card.style.cursor = 'default';
            card.innerHTML = `
              <div class="place-name" style="${isToday ? 'color: var(--accent-green);' : ''}">${escapeHtml(dayData.name)}</div>
              <div class="pharmacy-day">${dayNames[key]}</div>
              ${dayData.address ? `<div class="place-address">📍 ${escapeHtml(dayData.address)}</div>` : ''}
              ${dayData.phone ? `<div style="margin-top: 8px; color: var(--text-secondary);">📞 ${escapeHtml(dayData.phone)}</div>` : ''}
            `;
            body.appendChild(card);
          }
        });
        
      } catch (error) {
        console.error('Eczane hatası:', error);
        body.innerHTML = '<div class="empty-state-text">Yüklenirken hata oluştu</div>';
      }
    }
    
    function closePharmaciesModal() {
      document.getElementById('pharmacies-modal').classList.remove('active');
    }
    
    // Support
    function showSupport() {
      closeMenuModal();
      document.getElementById('support-modal').classList.add('active');
      setTimeout(() => document.getElementById('support-name').focus(), 100);
    }
    
    function closeSupportModal() {
      document.getElementById('support-modal').classList.remove('active');
    }
    
    async function submitSupport() {
      const name = document.getElementById('support-name').value.trim();
      const email = document.getElementById('support-email').value.trim();
      const subject = document.getElementById('support-subject').value.trim();
      const message = document.getElementById('support-message').value.trim();
      
      if (!name) { showToast('İsim soyisim gerekli!', 'error'); return; }
      if (!email) { showToast('Email gerekli!', 'error'); return; }
      if (!email.includes('@') || !email.includes('.')) {
        showToast('Geçerli bir email girin!', 'error');
        return;
      }
      if (!subject) { showToast('Konu gerekli!', 'error'); return; }
      if (!message) { showToast('Mesaj gerekli!', 'error'); return; }
      
      try {
        await db.collection('support').add({
          name,
          email,
          subject,
          message,
          status: 'pending',
          createdAt: firebase.firestore.FieldValue.serverTimestamp()
        });
        
        showToast('Talebiniz gönderildi!', 'success');
        closeSupportModal();
        
        // Clear form
        document.getElementById('support-name').value = '';
        document.getElementById('support-email').value = '';
        document.getElementById('support-subject').value = '';
        document.getElementById('support-message').value = '';
      } catch (error) {
        console.error('Hata:', error);
        showToast('Gönderilemedi!', 'error');
      }
    }
    
    // Admin
    function showAdminLogin() {
      document.getElementById('admin-pin-modal').classList.add('active');
      setTimeout(() => document.getElementById('admin-pin-input').focus(), 100);
    }
    
    function closeAdminPinModal() {
      document.getElementById('admin-pin-modal').classList.remove('active');
      document.getElementById('admin-pin-input').value = '';
    }
    
    function checkAdminPin() {
      const pin = document.getElementById('admin-pin-input').value;
      if (pin === '1234') {
        isAdminMode = true;
        closeAdminPinModal();
        openAdminPanel();
        showToast('Admin girişi yapıldı!', 'success');
      } else {
        showToast('Hatalı PIN!', 'error');
        document.getElementById('admin-pin-input').value = '';
      }
    }
    
    function openAdminPanel() {
      document.getElementById('admin-panel').classList.add('active');
      switchAdminTab('places');
    }
    
    function closeAdminPanel() {
      document.getElementById('admin-panel').classList.remove('active');
    }
    
    function switchAdminTab(tab) {
      currentAdminTab = tab;
      
      // Update tabs
      document.querySelectorAll('.admin-tab').forEach(t => t.classList.remove('active'));
      document.querySelectorAll('.admin-tab-content').forEach(t => t.classList.remove('active'));
      
      const tabButtons = document.querySelectorAll('.admin-tab');
      const tabMap = { 'places': 0, 'categories': 1, 'pharmacies': 2, 'support': 3, 'settings': 4 };
      tabButtons[tabMap[tab]].classList.add('active');
      
      document.getElementById(`admin-${tab}-tab`).classList.add('active');
      
      // Load data
      if (tab === 'places') {
        loadAdminPlacesList();
      } else if (tab === 'categories') {
        loadAdminCategoriesList();
      } else if (tab === 'pharmacies') {
        loadAdminPharmaciesList();
      } else if (tab === 'support') {
        loadAdminSupportList();
      } else if (tab === 'settings') {
        loadAboutData();
      }
    }
    
    function loadAdminPlacesList() {
      const container = document.getElementById('admin-places-list');
      if (allPlaces.length === 0) {
        container.innerHTML = '<div class="empty-state-text">Henüz mekan yok</div>';
        return;
      }
      container.innerHTML = '';
      allPlaces.forEach(place => {
        const item = document.createElement('div');
        item.className = 'admin-list-item';
        const categoryInfo = categories.find(c => c.id === place.category) || { icon: '📌' };
        item.innerHTML = `
          <div>
            <div style="font-weight: 700; margin-bottom: 6px; font-size: 15px;">${categoryInfo.icon} ${escapeHtml(place.name)}</div>
            <div style="font-size: 13px; color: var(--text-secondary);">${place.district || 'İlçe yok'} • ${place.address || 'Adres yok'}</div>
          </div>
          <div class="admin-item-actions">
            <button class="btn btn-secondary" onclick="editPlace('${place.id}')" style="padding: 8px 14px; font-size: 13px;">✏️</button>
            <button class="btn btn-secondary" onclick="deletePlace('${place.id}')" style="padding: 8px 14px; font-size: 13px;">🗑️</button>
          </div>
        `;
        container.appendChild(item);
      });
    }
    
    async function loadAdminPharmaciesList() {
      const container = document.getElementById('admin-pharmacies-list');
      try {
        const snapshot = await db.collection('pharmacies').orderBy('weekStart', 'desc').get();
        if (snapshot.empty) {
          container.innerHTML = '<div class="empty-state-text">Henüz hafta eklenmemiş</div>';
          return;
        }
        container.innerHTML = '';
        snapshot.forEach(doc => {
          const data = doc.data();
          const item = document.createElement('div');
          item.className = 'admin-list-item';
          item.innerHTML = `
            <div>
              <div style="font-weight: 700; margin-bottom: 6px;">🏥 Hafta: ${data.weekStart}</div>
              <div style="font-size: 13px; color: var(--text-secondary);">7 eczane kaydı</div>
            </div>
            <div class="admin-item-actions">
              <button class="btn btn-secondary" onclick="deletePharmacyWeek('${doc.id}')" style="padding: 8px 14px; font-size: 13px;">🗑️</button>
            </div>
          `;
          container.appendChild(item);
        });
      } catch (error) {
        console.error('Hata:', error);
        container.innerHTML = '<div class="empty-state-text">Yüklenemedi</div>';
      }
    }
    
    async function loadAdminSupportList() {
      const container = document.getElementById('admin-support-list');
      try {
        const snapshot = await db.collection('support').orderBy('createdAt', 'desc').get();
        if (snapshot.empty) {
          container.innerHTML = '<div class="empty-state-text">Henüz talep yok</div>';
          return;
        }
        container.innerHTML = '';
        snapshot.forEach(doc => {
          const data = doc.data();
          const item = document.createElement('div');
          item.className = 'admin-list-item';
          item.style.display = 'block';
          item.innerHTML = `
            <div style="margin-bottom: 12px;">
              <div style="font-weight: 700; margin-bottom: 6px;">${escapeHtml(data.name)}</div>
              <div style="font-size: 13px; color: var(--text-secondary); margin-bottom: 4px;">📧 ${escapeHtml(data.email)}</div>
              <div style="font-size: 13px; color: var(--text-secondary); margin-bottom: 4px;">📌 ${escapeHtml(data.subject)}</div>
              <div style="font-size: 14px; margin-top: 8px;">${escapeHtml(data.message)}</div>
            </div>
            <div style="display: flex; gap: 8px; justify-content: flex-end;">
              <button class="btn btn-secondary" onclick="deleteSupportTicket('${doc.id}')" style="padding: 6px 12px; font-size: 13px;">🗑️ Sil</button>
            </div>
          `;
          container.appendChild(item);
        });
      } catch (error) {
        console.error('Hata:', error);
        container.innerHTML = '<div class="empty-state-text">Yüklenemedi</div>';
      }
    }
    
    async function loadAboutData() {
      try {
        const doc = await db.collection('settings').doc('about').get();
        if (doc.exists) {
          const data = doc.data();
          document.getElementById('about-title').value = data.title || 'LemmOn Mersin';
          document.getElementById('about-subtitle').value = data.subtitle || 'Mersin Şehir Rehberi';
          document.getElementById('about-description').value = data.description || '';
          document.getElementById('about-version').value = data.version || 'V2.0 • 2025';
        } else {
          // Set defaults
          document.getElementById('about-title').value = 'LemmOn Mersin';
          document.getElementById('about-subtitle').value = 'Mersin Şehir Rehberi';
          document.getElementById('about-description').value = 'Mersin\'deki en iyi mekanları keşfet! Cafeler, restoranlar, alışveriş merkezleri ve daha fazlası...';
          document.getElementById('about-version').value = 'V2.0 • 2025';
        }
      } catch (error) {
        console.error('Hakkımda yüklenemedi:', error);
      }
    }
    
    async function saveAboutData() {
      const title = document.getElementById('about-title').value.trim();
      const subtitle = document.getElementById('about-subtitle').value.trim();
      const description = document.getElementById('about-description').value.trim();
      const version = document.getElementById('about-version').value.trim();
      
      if (!title) { showToast('Başlık gerekli!', 'error'); return; }
      if (!subtitle) { showToast('Alt başlık gerekli!', 'error'); return; }
      if (!description) { showToast('Açıklama gerekli!', 'error'); return; }
      
      try {
        await db.collection('settings').doc('about').set({
          title,
          subtitle,
          description,
          version,
          updatedAt: firebase.firestore.FieldValue.serverTimestamp()
        });
        showToast('Hakkımda güncellendi!', 'success');
      } catch (error) {
        console.error('Hata:', error);
        showToast('Kaydedilemedi!', 'error');
      }
    }
    
    function resetPlaceForm() {
      document.getElementById('edit-place-id').value = '';
      document.getElementById('place-name').value = '';
      document.getElementById('place-category').value = '';
      document.getElementById('place-district').value = '';
      document.getElementById('place-price').value = '';
      document.getElementById('place-address').value = '';
      document.getElementById('place-phone').value = '';
      document.getElementById('place-lat').value = '';
      document.getElementById('place-lng').value = '';
      document.getElementById('place-open').value = '09:00';
      document.getElementById('place-close').value = '22:00';
      document.getElementById('place-description').value = '';
    }
    
    function editPlace(placeId) {
      const place = allPlaces.find(p => p.id === placeId);
      if (!place) return;
      document.getElementById('edit-place-id').value = place.id;
      document.getElementById('place-name').value = place.name || '';
      document.getElementById('place-category').value = place.category || '';
      document.getElementById('place-district').value = place.district || '';
      document.getElementById('place-price').value = place.priceRange || '';
      document.getElementById('place-address').value = place.address || '';
      document.getElementById('place-phone').value = place.phone || '';
      document.getElementById('place-lat').value = place.latitude || '';
      document.getElementById('place-lng').value = place.longitude || '';
      document.getElementById('place-open').value = place.openTime || '09:00';
      document.getElementById('place-close').value = place.closeTime || '22:00';
      document.getElementById('place-description').value = place.description || '';
      document.getElementById('place-name').scrollIntoView({ behavior: 'smooth', block: 'center' });
      showToast('Düzenleme modunda', 'success');
    }
    
    async function deletePlace(placeId) {
      if (!confirm('Bu mekanı silmek istediğinizden emin misiniz?')) return;
      try {
        await db.collection('places').doc(placeId).delete();
        showToast('Mekan silindi!', 'success');
        await loadPlaces();
        loadAdminPlacesList();
      } catch (error) {
        console.error('Hata:', error);
        showToast('Silinemedi!', 'error');
      }
    }
    
    async function savePlaceData() {
      const placeId = document.getElementById('edit-place-id').value;
      const name = document.getElementById('place-name').value.trim();
      const category = document.getElementById('place-category').value;
      const district = document.getElementById('place-district').value;
      const priceRange = document.getElementById('place-price').value;
      const address = document.getElementById('place-address').value.trim();
      const phone = document.getElementById('place-phone').value.trim();
      const lat = document.getElementById('place-lat').value;
      const lng = document.getElementById('place-lng').value;
      const openTime = document.getElementById('place-open').value;
      const closeTime = document.getElementById('place-close').value;
      const description = document.getElementById('place-description').value.trim();
      
      if (!name) { showToast('Mekan adı gerekli!', 'error'); return; }
      if (!category) { showToast('Kategori seçiniz!', 'error'); return; }
      if (!district) { showToast('İlçe seçiniz!', 'error'); return; }
      if (!address) { showToast('Adres gerekli!', 'error'); return; }
      
      const placeData = {
        name, category, district, priceRange, address, phone,
        latitude: lat ? parseFloat(lat) : null,
        longitude: lng ? parseFloat(lng) : null,
        openTime, closeTime, description,
        updatedAt: firebase.firestore.FieldValue.serverTimestamp()
      };
      
      try {
        if (placeId) {
          await db.collection('places').doc(placeId).update(placeData);
          showToast('Güncellendi!', 'success');
        } else {
          placeData.createdAt = firebase.firestore.FieldValue.serverTimestamp();
          await db.collection('places').add(placeData);
          showToast('Eklendi!', 'success');
        }
        resetPlaceForm();
        await loadPlaces();
        loadAdminPlacesList();
      } catch (error) {
        console.error('Hata:', error);
        showToast('Kaydedilemedi!', 'error');
      }
    }
    
    async function saveWeeklyPharmacies() {
      const weekStart = document.getElementById('pharmacy-week-start').value;
      if (!weekStart) {
        showToast('Hafta başlangıç tarihi seçiniz!', 'error');
        return;
      }
      
      const days = ['monday', 'tuesday', 'wednesday', 'thursday', 'friday', 'saturday', 'sunday'];
      const weekData = { weekStart };
      
      let hasData = false;
      days.forEach(day => {
        const name = document.getElementById(`pharmacy-${day}-name`).value.trim();
        const address = document.getElementById(`pharmacy-${day}-address`).value.trim();
        const phone = document.getElementById(`pharmacy-${day}-phone`).value.trim();
        
        if (name) {
          hasData = true;
          weekData[day] = { name, address, phone };
        }
      });
      
      if (!hasData) {
        showToast('En az bir eczane bilgisi girin!', 'error');
        return;
      }
      
      try {
        weekData.createdAt = firebase.firestore.FieldValue.serverTimestamp();
        await db.collection('pharmacies').add(weekData);
        showToast('Haftalık eczaneler kaydedildi!', 'success');
        
        // Clear form
        document.getElementById('pharmacy-week-start').value = '';
        days.forEach(day => {
          document.getElementById(`pharmacy-${day}-name`).value = '';
          document.getElementById(`pharmacy-${day}-address`).value = '';
          document.getElementById(`pharmacy-${day}-phone`).value = '';
        });
        
        loadAdminPharmaciesList();
      } catch (error) {
        console.error('Hata:', error);
        showToast('Kaydedilemedi!', 'error');
      }
    }
    
    async function deletePharmacyWeek(id) {
      if (!confirm('Bu haftayı silmek istediğinizden emin misiniz?')) return;
      try {
        await db.collection('pharmacies').doc(id).delete();
        showToast('Hafta silindi!', 'success');
        loadAdminPharmaciesList();
      } catch (error) {
        console.error('Hata:', error);
        showToast('Silinemedi!', 'error');
      }
    }
    
    async function deleteSupportTicket(id) {
      if (!confirm('Bu talebi silmek istediğinizden emin misiniz?')) return;
      try {
        await db.collection('support').doc(id).delete();
        showToast('Talep silindi!', 'success');
        loadAdminSupportList();
      } catch (error) {
        console.error('Hata:', error);
        showToast('Silinemedi!', 'error');
      }
    }
    
    // Backup
    function exportBackup() {
      const backup = {
        places: allPlaces,
        favorites: favorites,
        exportDate: new Date().toISOString(),
        version: '2.0'
      };
      const dataStr = JSON.stringify(backup, null, 2);
      const blob = new Blob([dataStr], { type: 'application/json' });
      const url = URL.createObjectURL(blob);
      const a = document.createElement('a');
      a.href = url;
      a.download = `lemmon-yedek-${new Date().getTime()}.json`;
      a.click();
      URL.revokeObjectURL(url);
      showToast('Yedek alındı!', 'success');
    }
    
    function importBackup() {
      const input = document.createElement('input');
      input.type = 'file';
      input.accept = '.json';
      input.onchange = async (e) => {
        const file = e.target.files[0];
        if (!file) return;
        try {
          const text = await file.text();
          const backup = JSON.parse(text);
          if (!backup.places || !Array.isArray(backup.places)) {
            throw new Error('Geçersiz yedek');
          }
          if (confirm(`${backup.places.length} mekan geri yüklenecek. Onaylıyor musunuz?`)) {
            // Firebase'e yükle
            for (const place of backup.places) {
              const { id, ...placeData } = place;
              await db.collection('places').add(placeData);
            }
            
            if (backup.favorites) {
              favorites = backup.favorites;
              saveFavoritesToStorage();
            }
            
            showToast('Yedek yüklendi!', 'success');
            await loadPlaces();
          }
        } catch (error) {
          console.error('Hata:', error);
          showToast('Yedek yüklenemedi!', 'error');
        }
      };
      input.click();
    }
    
    // Utility Functions
    function getPlaceStatus(place) {
      if (!place.openTime || !place.closeTime) return null;
      
      const now = new Date();
      const currentHours = now.getHours();
      const currentMinutes = now.getMinutes();
      const currentTime = currentHours * 60 + currentMinutes;
      
      const [openH, openM] = place.openTime.split(':').map(Number);
      const [closeH, closeM] = place.closeTime.split(':').map(Number);
      const openTime = openH * 60 + openM;
      const closeTime = closeH * 60 + closeM;
      
      const isOpen = currentTime >= openTime && currentTime < closeTime;
      
      return isOpen 
        ? { class: 'open', icon: '🟢', text: 'Açık' }
        : { class: 'closed', icon: '🔴', text: 'Kapalı' };
    }
    
    function escapeHtml(text) {
      if (!text) return '';
      const div = document.createElement('div');
      div.textContent = text;
      return div.innerHTML;
    }
    
    function showEmptyState(message) {
      const container = document.getElementById('main-content');
      container.innerHTML = `
        <div class="empty-state">
          <div class="empty-state-icon">🍋</div>
          <div class="empty-state-text">${message}</div>
        </div>
      `;
    }
    
    function showToast(message, type = 'success') {
      const toast = document.createElement('div');
      toast.className = `toast ${type}`;
      toast.textContent = message;
      document.body.appendChild(toast);
      
      setTimeout(() => toast.classList.add('show'), 100);
      
      setTimeout(() => {
        toast.classList.remove('show');
        setTimeout(() => toast.remove(), 400);
      }, 3000);
    }
    
    // Modal close on backdrop click
    document.querySelectorAll('.modal').forEach(modal => {
      modal.addEventListener('click', (e) => {
        if (e.target === modal) {
          modal.classList.remove('active');
        }
      });
    });
    
    console.log('🍋 LemmOn V2.0 hazır!');
  </script>
</body>
</html>

